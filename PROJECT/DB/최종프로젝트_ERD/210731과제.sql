-----------------------------------
--1. 관리사원 MANAGER
INSERT INTO MANAGER(MANAGER_NO, NAME, DEPT) VALUES ('1001', '조세진', '카드영업부');
INSERT INTO MANAGER(MANAGER_NO, NAME, DEPT) VALUES ('1002', '정현석', '카드영업부');
INSERT INTO MANAGER(MANAGER_NO, NAME, DEPT) VALUES ('1003', '윤소영', '카드영업부');
INSERT INTO MANAGER(MANAGER_NO, NAME, DEPT) VALUES ('1004', '안재훈', '카드영업부');
INSERT INTO MANAGER(MANAGER_NO, NAME, DEPT) VALUES ('1005', '이기찬', '카드영업부');
INSERT INTO MANAGER(MANAGER_NO, NAME, DEPT) VALUES ('1006', '김영업', '카드영업부');
INSERT INTO MANAGER(MANAGER_NO, NAME, DEPT) VALUES ('1007', '구영업', '카드영업부');
INSERT INTO MANAGER(MANAGER_NO, NAME, DEPT) VALUES ('1008', '조영업', '카드영업부');
INSERT INTO MANAGER(MANAGER_NO, NAME, DEPT) VALUES ('1009', '윤영업', '카드영업부');
INSERT INTO MANAGER(MANAGER_NO, NAME, DEPT) VALUES ('1010', '원영업', '카드영업부');

SELECT * FROM MANAGER;
-----------------------------------
--2. 사용자정보 USER
SELECT * FROM MEMBER;

INSERT INTO MEMBER(ID, PW, MEMBER_NAME, MOBILE_NO, RRN, MANAGER_NO, USER_TYPE, AGE, ADDRESS, ADDRESS_DETAIL) VALUES ('test1', 'test1', '구본성', '010-4773-9853', '950101-1111111', '1001', 1,27, '경기 광명시', '융기원');
INSERT INTO MEMBER(ID, PW, MEMBER_NAME, MOBILE_NO, RRN, MANAGER_NO, USER_TYPE, AGE, ADDRESS, ADDRESS_DETAIL) VALUES ('test2', 'test2', '안효진', '010-1111-2222', '950101-2111111', '1002', 2,25, '서울 영등포구', '용산');
INSERT INTO MEMBER(ID, PW, MEMBER_NAME, MOBILE_NO, RRN, MANAGER_NO, USER_TYPE, AGE, ADDRESS, ADDRESS_DETAIL) VALUES ('test3', 'test3', '윤정환', '010-3333-4444', '920101-1111111', '1003', 2,27, '서울 영등포구', '용산');
INSERT INTO MEMBER(ID, PW, MEMBER_NAME, MOBILE_NO, RRN, MANAGER_NO, USER_TYPE, AGE, ADDRESS, ADDRESS_DETAIL) VALUES ('test4', 'test4', '황준호', '010-5555-6666', '940101-1111111', '1004', 2,28, '서울 영등포구', '용산');
INSERT INTO MEMBER(ID, PW, MEMBER_NAME, MOBILE_NO, RRN, MANAGER_NO, USER_TYPE, AGE, ADDRESS, ADDRESS_DETAIL) VALUES ('test5', 'test5', '안종범', '010-7777-8888', '930101-1111111', '1005', 2,29, '서울 영등포구', '용산');
INSERT INTO MEMBER(ID, PW, MEMBER_NAME, MOBILE_NO, RRN, MANAGER_NO, USER_TYPE, AGE, ADDRESS, ADDRESS_DETAIL) VALUES ('test6', 'test6', '김회원', '010-1111-1112', '950101-1111112', '1006', 2,30, '서울 영등포구', '용산');
INSERT INTO MEMBER(ID, PW, MEMBER_NAME, MOBILE_NO, RRN, MANAGER_NO, USER_TYPE, AGE, ADDRESS, ADDRESS_DETAIL) VALUES ('test7', 'test7', '안회원', '010-1111-2223', '950101-1111113', '1007', 21,31, '서울 영등포구', '용산');
INSERT INTO MEMBER(ID, PW, MEMBER_NAME, MOBILE_NO, RRN, MANAGER_NO, USER_TYPE, AGE, ADDRESS, ADDRESS_DETAIL) VALUES ('test8', 'test8', '조회원', '010-1111-2224', '950101-1111114', '1008', 2,32, '서울 영등포구', '용산');
INSERT INTO MEMBER(ID, PW, MEMBER_NAME, MOBILE_NO, RRN, MANAGER_NO, USER_TYPE, AGE, ADDRESS, ADDRESS_DETAIL) VALUES ('test9', 'test9', '윤회원', '010-1111-2225', '950101-1111115', '1009', 2,25, '서울 영등포구', '용산');
INSERT INTO MEMBER(ID, PW, MEMBER_NAME, MOBILE_NO, RRN, MANAGER_NO, USER_TYPE, AGE, ADDRESS, ADDRESS_DETAIL) VALUES ('test10', 'test10', '구회원', '010-1111-2226', '950101-1111161', '1010', 1,25, '서울 영등포구', '용산');

-----------------------------------
--3. 문의게시판 QA_BOARD
SELECT * FROM QA_BOARD;

INSERT INTO QA_BOARD(MEMBER_NO, UPPER_NO, CONTENT, REPLY, VIEW_CNT, CONTENT_CATEGORY) VALUES (1, -1, 'TEST내용입니다1', '댓글입니다', 20, '사용관련문의');
INSERT INTO QA_BOARD(MEMBER_NO, UPPER_NO, CONTENT, REPLY, VIEW_CNT, CONTENT_CATEGORY) VALUES (2, -1, 'TEST내용입니다1', '댓글입니다', 14, '구매관련문의');
INSERT INTO QA_BOARD(MEMBER_NO, UPPER_NO, CONTENT, REPLY, VIEW_CNT, CONTENT_CATEGORY) VALUES (5, -1, 'TEST내용입니다1', '댓글입니다', 20, '기타문의');
INSERT INTO QA_BOARD(MEMBER_NO, UPPER_NO, CONTENT, REPLY, VIEW_CNT, CONTENT_CATEGORY) VALUES (6, 5, 'TEST내용입니다1', '댓글입니다', 12, '사용관련문의');
INSERT INTO QA_BOARD(MEMBER_NO, UPPER_NO, CONTENT, REPLY, VIEW_CNT, CONTENT_CATEGORY) VALUES (5, 4, 'TEST내용입니다1', '댓글입니다', 20, '사용관련문의');
INSERT INTO QA_BOARD(MEMBER_NO, UPPER_NO, CONTENT, REPLY, VIEW_CNT, CONTENT_CATEGORY) VALUES (1, -1, 'TEST내용입니다1', '댓글입니다', 20, '사용관련문의');
INSERT INTO QA_BOARD(MEMBER_NO, UPPER_NO, CONTENT, REPLY, VIEW_CNT, CONTENT_CATEGORY) VALUES (2, 6, 'TEST내용입니다1', '댓글입니다', 6, '사용관련문의');
INSERT INTO QA_BOARD(MEMBER_NO, UPPER_NO, CONTENT, REPLY, VIEW_CNT, CONTENT_CATEGORY) VALUES (5, -1, 'TEST내용입니다1', '댓글입니다', 20, '사용관련문의');
INSERT INTO QA_BOARD(MEMBER_NO, UPPER_NO, CONTENT, REPLY, VIEW_CNT, CONTENT_CATEGORY) VALUES (6, 3, 'TEST내용입니다1', '댓글입니다', 20, '사용관련문의');
INSERT INTO QA_BOARD(MEMBER_NO, UPPER_NO, CONTENT, REPLY, VIEW_CNT, CONTENT_CATEGORY) VALUES (5, -1, 'TEST내용입니다1', '댓글입니다', 20, '사용관련문의');

-----------------------------------
--4. 사용자계좌 MEMBER_ACCOUNT
SELECT * FROM MEMBER_ACCOUNT;

INSERT INTO MEMBER_ACCOUNT(ACC_NO, BALANCE, ACC_PW, ACC_NICKNAME, MEMBER_NO) VALUES ('111-111-111', 10000, '1234', '체크카드용', 1);
INSERT INTO MEMBER_ACCOUNT(ACC_NO, BALANCE, ACC_PW, ACC_NICKNAME, MEMBER_NO) VALUES ('111-111-112', 20000, '1234', '체크카드용', 2);
INSERT INTO MEMBER_ACCOUNT(ACC_NO, BALANCE, ACC_PW, ACC_NICKNAME, MEMBER_NO) VALUES ('111-111-113', 30000, '1234', '체크카드용', 7);
INSERT INTO MEMBER_ACCOUNT(ACC_NO, BALANCE, ACC_PW, ACC_NICKNAME, MEMBER_NO) VALUES ('111-111-114', 40000, '1234', '체크카드용', 1);
INSERT INTO MEMBER_ACCOUNT(ACC_NO, BALANCE, ACC_PW, ACC_NICKNAME, MEMBER_NO) VALUES ('111-111-115', 50000, '1234', '체크카드용', 5);
INSERT INTO MEMBER_ACCOUNT(ACC_NO, BALANCE, ACC_PW, ACC_NICKNAME, MEMBER_NO) VALUES ('111-111-116', 60000, '1234', '체크카드용', 6);
INSERT INTO MEMBER_ACCOUNT(ACC_NO, BALANCE, ACC_PW, ACC_NICKNAME, MEMBER_NO) VALUES ('111-111-117', 70000, '1234', '체크카드용', 2);
INSERT INTO MEMBER_ACCOUNT(ACC_NO, BALANCE, ACC_PW, ACC_NICKNAME, MEMBER_NO) VALUES ('111-111-118', 80000, '1234', '체크카드용', 5);
INSERT INTO MEMBER_ACCOUNT(ACC_NO, BALANCE, ACC_PW, ACC_NICKNAME, MEMBER_NO) VALUES ('111-111-119', 90000, '1234', '체크카드용', 2);
INSERT INTO MEMBER_ACCOUNT(ACC_NO, BALANCE, ACC_PW, ACC_NICKNAME, MEMBER_NO) VALUES ('111-111-110', 10000, '1234', '체크카드용', 1);
-----------------------------------
--5. 카드정보 CARD_INFO
SELECT * FROM CARD_INFO;

INSERT INTO CARD_INFO(CARD_NAME, CARD_CREATING_DATE, CARD_CATEGORY) VALUES ('하나카드1', '2021-01-01', '체크카드');
INSERT INTO CARD_INFO(CARD_NAME, CARD_CREATING_DATE, CARD_CATEGORY) VALUES ('하나카드2', '2020-01-01', '체크카드');
INSERT INTO CARD_INFO(CARD_NAME, CARD_CREATING_DATE, CARD_CATEGORY) VALUES ('하나카드3', '2019-01-01', '신용카드');
INSERT INTO CARD_INFO(CARD_NAME, CARD_CREATING_DATE, CARD_CATEGORY) VALUES ('하나카드4', '2020-01-01', '체크카드');
INSERT INTO CARD_INFO(CARD_NAME, CARD_CREATING_DATE, CARD_CATEGORY) VALUES ('하나카드5', '2020-01-01', '신용카드');
INSERT INTO CARD_INFO(CARD_NAME, CARD_CREATING_DATE, CARD_CATEGORY) VALUES ('하나카드6', '2019-01-01', '체크카드');
INSERT INTO CARD_INFO(CARD_NAME, CARD_CREATING_DATE, CARD_CATEGORY) VALUES ('하나카드7', '2018-01-01', '체크카드');
INSERT INTO CARD_INFO(CARD_NAME, CARD_CREATING_DATE, CARD_CATEGORY) VALUES ('하나카드8', '2020-01-01', '체크카드');
INSERT INTO CARD_INFO(CARD_NAME, CARD_CREATING_DATE, CARD_CATEGORY) VALUES ('하나카드9', '2018-01-01', '체크카드');
INSERT INTO CARD_INFO(CARD_NAME, CARD_CREATING_DATE, CARD_CATEGORY) VALUES ('하나카드10', '2021-01-01', '체크카드');
-----------------------------------
--6. 사용자카드 MEMBER_CARD
SELECT * FROM MEMBER_CARD;

INSERT INTO MEMBER_CARD(CARD_NO, CARD_NAME, CARD_PASSWORD, ACC_NO) VALUES ('1010-1010-1010-1010', '하나카드1', '1234', '111-111-111');
INSERT INTO MEMBER_CARD(CARD_NO, CARD_NAME, CARD_PASSWORD, ACC_NO) VALUES ('1010-1010-1010-1011', '하나카드2', '1234', '111-111-112');
INSERT INTO MEMBER_CARD(CARD_NO, CARD_NAME, CARD_PASSWORD, ACC_NO) VALUES ('1010-1010-1010-1012', '하나카드3', '1234', '111-111-113');
INSERT INTO MEMBER_CARD(CARD_NO, CARD_NAME, CARD_PASSWORD, ACC_NO) VALUES ('1010-1010-1010-1013', '하나카드4', '1234', '111-111-114');
INSERT INTO MEMBER_CARD(CARD_NO, CARD_NAME, CARD_PASSWORD, ACC_NO) VALUES ('1010-1010-1010-1014', '하나카드5', '1234', '111-111-115');
INSERT INTO MEMBER_CARD(CARD_NO, CARD_NAME, CARD_PASSWORD, ACC_NO) VALUES ('1010-1010-1010-1015', '하나카드6', '1234', '111-111-116');
INSERT INTO MEMBER_CARD(CARD_NO, CARD_NAME, CARD_PASSWORD, ACC_NO) VALUES ('1010-1010-1010-1016', '하나카드7', '1234', '111-111-117');
INSERT INTO MEMBER_CARD(CARD_NO, CARD_NAME, CARD_PASSWORD, ACC_NO) VALUES ('1010-1010-1010-1017', '하나카드8', '1234', '111-111-118');
INSERT INTO MEMBER_CARD(CARD_NO, CARD_NAME, CARD_PASSWORD, ACC_NO) VALUES ('1010-1010-1010-1018', '하나카드9', '1234', '111-111-119');
INSERT INTO MEMBER_CARD(CARD_NO, CARD_NAME, CARD_PASSWORD, ACC_NO) VALUES ('1010-1010-1010-1019', '하나카드10', '1234', '111-111-110');

-----------------------------------
--7. 사용자거래내역 TRANSACTION_HISTORY
SELECT * FROM TRANSACTION_HISTORY;

INSERT INTO TRANSACTION_HISTORY(HISTORY_TIME, AMOUNT, CATEGORY, STORE, CARD_NO) VALUES('10:00', 10000, '미용', '올리브영', '1010-1010-1010-1010');
INSERT INTO TRANSACTION_HISTORY(HISTORY_TIME, AMOUNT, CATEGORY, STORE, CARD_NO) VALUES('11:00', 10000, '음식', '맥도날드', '1010-1010-1010-1010');
INSERT INTO TRANSACTION_HISTORY(HISTORY_TIME, AMOUNT, CATEGORY, STORE, CARD_NO) VALUES('12:00', 10000, '교통', '버스', '1010-1010-1010-1010');
INSERT INTO TRANSACTION_HISTORY(HISTORY_TIME, AMOUNT, CATEGORY, STORE, CARD_NO) VALUES('13:00', 10000, '음식', 'KFC', '1010-1010-1010-1010');
INSERT INTO TRANSACTION_HISTORY(HISTORY_TIME, AMOUNT, CATEGORY, STORE, CARD_NO) VALUES('14:00', 10000, '교통', '지하철', '1010-1010-1010-1010');
INSERT INTO TRANSACTION_HISTORY(HISTORY_TIME, AMOUNT, CATEGORY, STORE, CARD_NO) VALUES('15:00', 10000, '미용', '올리브영', '1010-1010-1010-1010');
INSERT INTO TRANSACTION_HISTORY(HISTORY_TIME, AMOUNT, CATEGORY, STORE, CARD_NO) VALUES('16:00', 10000, '미용', '올리브영', '1010-1010-1010-1010');
INSERT INTO TRANSACTION_HISTORY(HISTORY_TIME, AMOUNT, CATEGORY, STORE, CARD_NO) VALUES('17:00', 10000, '미용', '올리브영', '1010-1010-1010-1010');
INSERT INTO TRANSACTION_HISTORY(HISTORY_TIME, AMOUNT, CATEGORY, STORE, CARD_NO) VALUES('18:00', 10000, '미용', '올리브영', '1010-1010-1010-1010');
INSERT INTO TRANSACTION_HISTORY(HISTORY_TIME, AMOUNT, CATEGORY, STORE, CARD_NO) VALUES('19:00', 10000, '미용', '올리브영', '1010-1010-1010-1010');
INSERT INTO TRANSACTION_HISTORY(HISTORY_TIME, AMOUNT, CATEGORY, STORE, CARD_NO) VALUES('19:00', 10000, '미용', '올리브영', '1010-1010-1010-1011');
INSERT INTO TRANSACTION_HISTORY(HISTORY_TIME, AMOUNT, CATEGORY, STORE, CARD_NO) VALUES('19:00', 4000, '교통', '올리브영', '1010-1010-1010-1011');
-----------------------------------
--8. 사용자카드리뷰 CARD_REVIEW

SELECT * FROM CARD_REVIEW;

INSERT INTO CARD_REVIEW(GRADE, BODY, CARD_NO) VALUES (2, '정말 별로에요', '1010-1010-1010-1010');
INSERT INTO CARD_REVIEW(GRADE, BODY, CARD_NO) VALUES (5, '정말 좋아요', '1010-1010-1010-1011');
INSERT INTO CARD_REVIEW(GRADE, BODY, CARD_NO) VALUES (2, '정말 별로에요', '1010-1010-1010-1012');
INSERT INTO CARD_REVIEW(GRADE, BODY, CARD_NO) VALUES (2, '정말 별로에요', '1010-1010-1010-1013');
INSERT INTO CARD_REVIEW(GRADE, BODY, CARD_NO) VALUES (2, '정말 별로에요', '1010-1010-1010-1014');
INSERT INTO CARD_REVIEW(GRADE, BODY, CARD_NO) VALUES (1, '정말 그냥 그래요', '1010-1010-1010-1015');
INSERT INTO CARD_REVIEW(GRADE, BODY, CARD_NO) VALUES (2, '정말 별로에요', '1010-1010-1010-1016');
INSERT INTO CARD_REVIEW(GRADE, BODY, CARD_NO) VALUES (2, '정말 별로에요', '1010-1010-1010-1017');
INSERT INTO CARD_REVIEW(GRADE, BODY, CARD_NO) VALUES (2, '정말 별로에요', '1010-1010-1010-1018');
INSERT INTO CARD_REVIEW(GRADE, BODY, CARD_NO) VALUES (2, '정말 별로에요', '1010-1010-1010-1019');

-----------------------------------
--9. 월간요약통계 MONTHLY SUMMARY
SELECT * FROM MONTHLY_SUMMARY;

INSERT INTO MONTHLY_SUMMARY(CARD_NO, MOST_EXPENDITURE_CATEGORIES, MAX_OF_EXPENDITURE, AVG_OF_EXPENDITURE_PER_CASE, MAX_EXPENDITURE_AREA, MAIN_CARD_NAME)
VALUES('1010-1010-1010-1010', '음식', 100000, 2500,'서울 종로구', '주거래카드');
INSERT INTO MONTHLY_SUMMARY(CARD_NO, MOST_EXPENDITURE_CATEGORIES, MAX_OF_EXPENDITURE, AVG_OF_EXPENDITURE_PER_CASE, MAX_EXPENDITURE_AREA, MAIN_CARD_NAME)
VALUES('1010-1010-1010-1011', '교통', 100000, 2500,'서울 종로구', '주거래카드');
INSERT INTO MONTHLY_SUMMARY(CARD_NO, MOST_EXPENDITURE_CATEGORIES, MAX_OF_EXPENDITURE, AVG_OF_EXPENDITURE_PER_CASE, MAX_EXPENDITURE_AREA, MAIN_CARD_NAME)
VALUES('1010-1010-1010-1012', '유흥', 100000, 2500,'서울 종로구', '주거래카드');
INSERT INTO MONTHLY_SUMMARY(CARD_NO, MOST_EXPENDITURE_CATEGORIES, MAX_OF_EXPENDITURE, AVG_OF_EXPENDITURE_PER_CASE, MAX_EXPENDITURE_AREA, MAIN_CARD_NAME)
VALUES('1010-1010-1010-1013', '카페', 100000, 2500,'서울 종로구', '주거래카드');
INSERT INTO MONTHLY_SUMMARY(CARD_NO, MOST_EXPENDITURE_CATEGORIES, MAX_OF_EXPENDITURE, AVG_OF_EXPENDITURE_PER_CASE, MAX_EXPENDITURE_AREA, MAIN_CARD_NAME)
VALUES('1010-1010-1010-1014', '음식', 100000, 2500,'서울 종로구', '주거래카드');
INSERT INTO MONTHLY_SUMMARY(CARD_NO, MOST_EXPENDITURE_CATEGORIES, MAX_OF_EXPENDITURE, AVG_OF_EXPENDITURE_PER_CASE, MAX_EXPENDITURE_AREA, MAIN_CARD_NAME)
VALUES('1010-1010-1010-1015', '음식', 100000, 2500,'서울 종로구', '주거래카드');
INSERT INTO MONTHLY_SUMMARY(CARD_NO, MOST_EXPENDITURE_CATEGORIES, MAX_OF_EXPENDITURE, AVG_OF_EXPENDITURE_PER_CASE, MAX_EXPENDITURE_AREA, MAIN_CARD_NAME)
VALUES('1010-1010-1010-1016', '음식', 100000, 2500,'서울 종로구', '주거래카드');
INSERT INTO MONTHLY_SUMMARY(CARD_NO, MOST_EXPENDITURE_CATEGORIES, MAX_OF_EXPENDITURE, AVG_OF_EXPENDITURE_PER_CASE, MAX_EXPENDITURE_AREA, MAIN_CARD_NAME)
VALUES('1010-1010-1010-1017', '음식', 100000, 2500,'서울 종로구', '주거래카드');
INSERT INTO MONTHLY_SUMMARY(CARD_NO, MOST_EXPENDITURE_CATEGORIES, MAX_OF_EXPENDITURE, AVG_OF_EXPENDITURE_PER_CASE, MAX_EXPENDITURE_AREA, MAIN_CARD_NAME)
VALUES('1010-1010-1010-1018', '음식', 100000, 2500,'서울 종로구', '주거래카드');
INSERT INTO MONTHLY_SUMMARY(CARD_NO, MOST_EXPENDITURE_CATEGORIES, MAX_OF_EXPENDITURE, AVG_OF_EXPENDITURE_PER_CASE, MAX_EXPENDITURE_AREA, MAIN_CARD_NAME)
VALUES('1010-1010-1010-1019', '음식', 100000, 2500,'서울 종로구', '주거래카드');

-----------------------------------
--10. 공통코드 TOTAL_CODE
SELECT * FROM TOTAL_CODE;
--미정

-----------------------------------
--11. 요약통계로그 SUMMARY_LOG
SELECT * FROM SUMMARY_LOG;

INSERT INTO SUMMARY_LOG(SENDING_DATE, TOTAL, OPEN_RATE) VALUES('2021-01-01', 100000, 30000);
INSERT INTO SUMMARY_LOG(SENDING_DATE, TOTAL, OPEN_RATE) VALUES('2021-02-01', 110000, 70000);
INSERT INTO SUMMARY_LOG(SENDING_DATE, TOTAL, OPEN_RATE) VALUES('2021-03-01', 120000, 80000);
INSERT INTO SUMMARY_LOG(SENDING_DATE, TOTAL, OPEN_RATE) VALUES('2021-04-01', 130000, 90000);
INSERT INTO SUMMARY_LOG(SENDING_DATE, TOTAL, OPEN_RATE) VALUES('2021-05-01', 140000, 100000);
INSERT INTO SUMMARY_LOG(SENDING_DATE, TOTAL, OPEN_RATE) VALUES('2021-06-01', 150000, 100000);
INSERT INTO SUMMARY_LOG(SENDING_DATE, TOTAL, OPEN_RATE) VALUES('2021-07-01', 160000, 100000);
INSERT INTO SUMMARY_LOG(SENDING_DATE, TOTAL, OPEN_RATE) VALUES('2021-08-01', 170000, 100000);
INSERT INTO SUMMARY_LOG(SENDING_DATE, TOTAL, OPEN_RATE) VALUES('2021-09-01', 180000, 100000);
INSERT INTO SUMMARY_LOG(SENDING_DATE, TOTAL, OPEN_RATE) VALUES('2021-10-01', 190000, 100000);

COMMIT;


-----------------------
-- SELECT를 통한 INSIGHT 추출

SELECT M.MEMBER_NO, M.MEMBER_NAME, A.ACC_NO, C.CARD_NAME
FROM MEMBER M, MEMBER_ACCOUNT A , MEMBER_CARD C WHERE M.MEMBER_NO = A.MEMBER_NO AND A.ACC_NO = C.ACC_NO AND CARD_NAME='하나카드1';

-- 하나카드1을 사용하는 고객을 찾는 쿼리
-- 관리자의 입장에서 어떤 카드가 가장 많이 사용하는지 알아볼때 사용

SELECT A.MEMBER_NAME, A.CARD_NO ,B.TOTAL_AMOUNT FROM (SELECT M.MEMBER_NO, M.MEMBER_NAME, A.ACC_NO, C.CARD_NO
FROM MEMBER M, MEMBER_ACCOUNT A , MEMBER_CARD C WHERE M.MEMBER_NO = A.MEMBER_NO AND A.ACC_NO = C.ACC_NO) A,
(SELECT CARD_NO, SUM(AMOUNT) AS TOTAL_AMOUNT FROM TRANSACTION_HISTORY GROUP BY CARD_NO) B
WHERE A.CARD_NO = B.CARD_NO;

-- 거래가 발생한 카드 중에서, 사람별로 가장 많은 거래가 발생한 카드 (주거래 카드)를 알아보는 쿼리
