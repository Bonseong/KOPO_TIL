-----------------------------------
--1. 사용자정보 T_MEMBER
SELECT * FROM T_MEMBER;

INSERT INTO T_MEMBER(ID, PW, NAME, MOBILE_NO, RRN, BIRTHDAY, AGE, GENDER, ISNATIVE, ADDRESS, ADDRESS_DETAIL) VALUES ('test1', 'test1', '구본성', '01047739853', '950101-1111111', '19950602', 26, 'M', 'N', '경기 광명시', '융기원');
INSERT INTO T_MEMBER(ID, PW, NAME, MOBILE_NO, RRN, BIRTHDAY, AGE, GENDER, ISNATIVE, ADDRESS, ADDRESS_DETAIL) VALUES ('test2', 'test2', '구본성', '01047739853', '950101-1111112', TO_DATE('1995-06-02'), 26, 'M', 'N', '경기 광명시', '융기원');
INSERT INTO T_MEMBER(ID, PW, NAME, MOBILE_NO, RRN, BIRTHDAY, AGE, GENDER, ISNATIVE, ADDRESS, ADDRESS_DETAIL) VALUES ('test3', 'test3', '구본성', '01047739853', '950101-1111113', TO_DATE('1995-06-02'), 26, 'M', 'N', '경기 광명시', '융기원');


commit;

-----------------------------------
--2. 카드정보 CARD_INFO
SELECT * FROM CARD_INFO;

INSERT INTO CARD_INFO(CARD_NAME, CARD_CREATING_DATE, CARD_CATEGORY) VALUES ('하나카드1', '2021-01-01', '체크카드');
INSERT INTO CARD_INFO(CARD_NAME, CARD_CREATING_DATE, CARD_CATEGORY) VALUES ('하나카드2', '2020-01-01', '체크카드');
INSERT INTO CARD_INFO(CARD_NAME, CARD_CREATING_DATE, CARD_CATEGORY) VALUES ('하나카드3', '2019-01-01', '신용카드');
INSERT INTO CARD_INFO(CARD_NAME, CARD_CREATING_DATE, CARD_CATEGORY) VALUES ('하나카드4', '2020-01-01', '체크카드');
INSERT INTO CARD_INFO(CARD_NAME, CARD_CREATING_DATE, CARD_CATEGORY) VALUES ('하나카드5', '2020-01-01', '신용카드');
INSERT INTO CARD_INFO(CARD_NAME, CARD_CREATING_DATE, CARD_CATEGORY) VALUES ('하나카드6', '2019-01-01', '체크카드');
INSERT INTO CARD_INFO(CARD_NAME, CARD_CREATING_DATE, CARD_CATEGORY) VALUES ('하나카드7', '2018-01-01', '체크카드');
INSERT INTO CARD_INFO(CARD_NAME, CARD_CREATING_DATE, CARD_CATEGORY) VALUES ('하나카드8', '2020-01-01', '체크카드');
INSERT INTO CARD_INFO(CARD_NAME, CARD_CREATING_DATE, CARD_CATEGORY) VALUES ('하나카드9', '2018-01-01', '체크카드');
INSERT INTO CARD_INFO(CARD_NAME, CARD_CREATING_DATE, CARD_CATEGORY) VALUES ('하나카드10', '2021-01-01', '체크카드');

-----------------------------------
--3. 사용자카드 MEMBER_CARD
SELECT * FROM MEMBER_CARD;

INSERT INTO MEMBER_CARD(CARD_NO, MEMBER_NO, CARD_NAME, CARD_PASSWORD, VALID_DATE, CARD_TYPE, CVC_NO) VALUES ('1010-1010-1010-1010', 1, '하나카드1', '1234', '2024-08-31', 'CHECK', '123');
INSERT INTO MEMBER_CARD(CARD_NO, MEMBER_NO, CARD_NAME, CARD_PASSWORD, VALID_DATE, CARD_TYPE, CVC_NO) VALUES ('1010-1010-1010-1011', 2, '하나카드2', '1234', '2024-08-31', 'CHECK', '234');
INSERT INTO MEMBER_CARD(CARD_NO, MEMBER_NO, CARD_NAME, CARD_PASSWORD, VALID_DATE, CARD_TYPE, CVC_NO) VALUES ('1010-1010-1010-1012', 3, '하나카드3', '1234', '2024-08-31', 'CHECK', '123');
INSERT INTO MEMBER_CARD(CARD_NO, MEMBER_NO, CARD_NAME, CARD_PASSWORD, VALID_DATE, CARD_TYPE, CVC_NO) VALUES ('1010-1010-1010-1013', 4, '하나카드4', '1234', '2024-08-31', 'CHECK', '123');
INSERT INTO MEMBER_CARD(CARD_NO, MEMBER_NO, CARD_NAME, CARD_PASSWORD, VALID_DATE, CARD_TYPE, CVC_NO) VALUES ('1010-1010-1010-1014', 5, '하나카드5', '1234', '2024-08-31', 'CREDIT', '234');
INSERT INTO MEMBER_CARD(CARD_NO, MEMBER_NO, CARD_NAME, CARD_PASSWORD, VALID_DATE, CARD_TYPE, CVC_NO) VALUES ('1010-1010-1010-1015', 6, '하나카드6', '1234', '2024-08-31', 'CHECK', '324');
INSERT INTO MEMBER_CARD(CARD_NO, MEMBER_NO, CARD_NAME, CARD_PASSWORD, VALID_DATE, CARD_TYPE, CVC_NO) VALUES ('1010-1010-1010-1016', 7, '하나카드7', '1234', '2024-08-31', 'CHECK', '234');
INSERT INTO MEMBER_CARD(CARD_NO, MEMBER_NO, CARD_NAME, CARD_PASSWORD, VALID_DATE, CARD_TYPE, CVC_NO) VALUES ('1010-1010-1010-1017', 8, '하나카드8', '1234', '2024-08-31', 'CREDIT', '432');
INSERT INTO MEMBER_CARD(CARD_NO, MEMBER_NO, CARD_NAME, CARD_PASSWORD, VALID_DATE, CARD_TYPE, CVC_NO) VALUES ('1010-1010-1010-1018', 9, '하나카드9', '1234', '2024-08-31', 'CHECK', '432');
INSERT INTO MEMBER_CARD(CARD_NO, MEMBER_NO, CARD_NAME, CARD_PASSWORD, VALID_DATE, CARD_TYPE, CVC_NO) VALUES ('1010-1010-1010-1019', 10, '하나카드10', '1234', '2024-08-31', 'CHECK', '123');






-----------------------------------
--1. 관리사원 MANAGER
INSERT INTO MANAGER(MANAGER_NO, NAME, DEPT) VALUES ('1001', '조세진', '카드영업부');
INSERT INTO MANAGER(MANAGER_NO, NAME, DEPT) VALUES ('1002', '정현석', '카드영업부');
INSERT INTO MANAGER(MANAGER_NO, NAME, DEPT) VALUES ('1003', '윤소영', '카드영업부');
INSERT INTO MANAGER(MANAGER_NO, NAME, DEPT) VALUES ('1004', '안재훈', '카드영업부');
INSERT INTO MANAGER(MANAGER_NO, NAME, DEPT) VALUES ('1005', '이기찬', '카드영업부');
INSERT INTO MANAGER(MANAGER_NO, NAME, DEPT) VALUES ('1006', '김영업', '카드영업부');
INSERT INTO MANAGER(MANAGER_NO, NAME, DEPT) VALUES ('1007', '구영업', '카드영업부');
INSERT INTO MANAGER(MANAGER_NO, NAME, DEPT) VALUES ('1008', '조영업', '카드영업부');
INSERT INTO MANAGER(MANAGER_NO, NAME, DEPT) VALUES ('1009', '윤영업', '카드영업부');
INSERT INTO MANAGER(MANAGER_NO, NAME, DEPT) VALUES ('1010', '원영업', '카드영업부');

SELECT * FROM MANAGER;

-----------------------------------
--3. 문의게시판 QA_BOARD
SELECT * FROM QA_BOARD;

INSERT INTO QA_BOARD(MEMBER_NO, UPPER_NO, CONTENT, REPLY, VIEW_CNT, CONTENT_CATEGORY) VALUES (1, -1, 'TEST내용입니다1', '댓글입니다', 20, '사용관련문의');
INSERT INTO QA_BOARD(MEMBER_NO, UPPER_NO, CONTENT, REPLY, VIEW_CNT, CONTENT_CATEGORY) VALUES (2, -1, 'TEST내용입니다1', '댓글입니다', 14, '구매관련문의');
INSERT INTO QA_BOARD(MEMBER_NO, UPPER_NO, CONTENT, REPLY, VIEW_CNT, CONTENT_CATEGORY) VALUES (5, -1, 'TEST내용입니다1', '댓글입니다', 20, '기타문의');
INSERT INTO QA_BOARD(MEMBER_NO, UPPER_NO, CONTENT, REPLY, VIEW_CNT, CONTENT_CATEGORY) VALUES (6, 5, 'TEST내용입니다1', '댓글입니다', 12, '사용관련문의');
INSERT INTO QA_BOARD(MEMBER_NO, UPPER_NO, CONTENT, REPLY, VIEW_CNT, CONTENT_CATEGORY) VALUES (5, 4, 'TEST내용입니다1', '댓글입니다', 20, '사용관련문의');
INSERT INTO QA_BOARD(MEMBER_NO, UPPER_NO, CONTENT, REPLY, VIEW_CNT, CONTENT_CATEGORY) VALUES (1, -1, 'TEST내용입니다1', '댓글입니다', 20, '사용관련문의');
INSERT INTO QA_BOARD(MEMBER_NO, UPPER_NO, CONTENT, REPLY, VIEW_CNT, CONTENT_CATEGORY) VALUES (2, 6, 'TEST내용입니다1', '댓글입니다', 6, '사용관련문의');
INSERT INTO QA_BOARD(MEMBER_NO, UPPER_NO, CONTENT, REPLY, VIEW_CNT, CONTENT_CATEGORY) VALUES (5, -1, 'TEST내용입니다1', '댓글입니다', 20, '사용관련문의');
INSERT INTO QA_BOARD(MEMBER_NO, UPPER_NO, CONTENT, REPLY, VIEW_CNT, CONTENT_CATEGORY) VALUES (6, 3, 'TEST내용입니다1', '댓글입니다', 20, '사용관련문의');
INSERT INTO QA_BOARD(MEMBER_NO, UPPER_NO, CONTENT, REPLY, VIEW_CNT, CONTENT_CATEGORY) VALUES (5, -1, 'TEST내용입니다1', '댓글입니다', 20, '사용관련문의');

-----------------------------------
--4. 사용자계좌 MEMBER_ACCOUNT
SELECT * FROM MEMBER_ACCOUNT;

INSERT INTO MEMBER_ACCOUNT(CVC_NO, BALANCE, ACC_PW, ACC_NICKNAME, MEMBER_NO) VALUES ('111-111-111', 10000, '1234', '체크카드용', 1);
INSERT INTO MEMBER_ACCOUNT(CVC_NO, BALANCE, ACC_PW, ACC_NICKNAME, MEMBER_NO) VALUES ('111-111-112', 20000, '1234', '체크카드용', 2);
INSERT INTO MEMBER_ACCOUNT(CVC_NO, BALANCE, ACC_PW, ACC_NICKNAME, MEMBER_NO) VALUES ('111-111-113', 30000, '1234', '체크카드용', 7);
INSERT INTO MEMBER_ACCOUNT(CVC_NO, BALANCE, ACC_PW, ACC_NICKNAME, MEMBER_NO) VALUES ('111-111-114', 40000, '1234', '체크카드용', 1);
INSERT INTO MEMBER_ACCOUNT(CVC_NO, BALANCE, ACC_PW, ACC_NICKNAME, MEMBER_NO) VALUES ('111-111-115', 50000, '1234', '체크카드용', 5);
INSERT INTO MEMBER_ACCOUNT(CVC_NO, BALANCE, ACC_PW, ACC_NICKNAME, MEMBER_NO) VALUES ('111-111-116', 60000, '1234', '체크카드용', 6);
INSERT INTO MEMBER_ACCOUNT(CVC_NO, BALANCE, ACC_PW, ACC_NICKNAME, MEMBER_NO) VALUES ('111-111-117', 70000, '1234', '체크카드용', 2);
INSERT INTO MEMBER_ACCOUNT(CVC_NO, BALANCE, ACC_PW, ACC_NICKNAME, MEMBER_NO) VALUES ('111-111-118', 80000, '1234', '체크카드용', 5);
INSERT INTO MEMBER_ACCOUNT(CVC_NO, BALANCE, ACC_PW, ACC_NICKNAME, MEMBER_NO) VALUES ('111-111-119', 90000, '1234', '체크카드용', 2);
INSERT INTO MEMBER_ACCOUNT(CVC_NO, BALANCE, ACC_PW, ACC_NICKNAME, MEMBER_NO) VALUES ('111-111-110', 10000, '1234', '체크카드용', 1);



-----------------------------------
--7. 사용자거래내역 TRANSACTION_HISTORY
SELECT * FROM TRANSACTION_HISTORY;

INSERT INTO TRANSACTION_HISTORY(HISTORY_TIME, AMOUNT, CATEGORY, STORE, CARD_NO) VALUES('10:00', 10000, '미용', '올리브영', '1010-1010-1010-1010');
INSERT INTO TRANSACTION_HISTORY(HISTORY_TIME, AMOUNT, CATEGORY, STORE, CARD_NO) VALUES('11:00', 10000, '음식', '맥도날드', '1010-1010-1010-1010');
INSERT INTO TRANSACTION_HISTORY(HISTORY_TIME, AMOUNT, CATEGORY, STORE, CARD_NO) VALUES('12:00', 10000, '교통', '버스', '1010-1010-1010-1010');
INSERT INTO TRANSACTION_HISTORY(HISTORY_TIME, AMOUNT, CATEGORY, STORE, CARD_NO) VALUES('13:00', 10000, '음식', 'KFC', '1010-1010-1010-1010');
INSERT INTO TRANSACTION_HISTORY(HISTORY_TIME, AMOUNT, CATEGORY, STORE, CARD_NO) VALUES('14:00', 10000, '교통', '지하철', '1010-1010-1010-1010');
INSERT INTO TRANSACTION_HISTORY(HISTORY_TIME, AMOUNT, CATEGORY, STORE, CARD_NO) VALUES('15:00', 10000, '미용', '올리브영', '1010-1010-1010-1010');
INSERT INTO TRANSACTION_HISTORY(HISTORY_TIME, AMOUNT, CATEGORY, STORE, CARD_NO) VALUES('16:00', 10000, '미용', '올리브영', '1010-1010-1010-1010');
INSERT INTO TRANSACTION_HISTORY(HISTORY_TIME, AMOUNT, CATEGORY, STORE, CARD_NO) VALUES('17:00', 10000, '미용', '올리브영', '1010-1010-1010-1010');
INSERT INTO TRANSACTION_HISTORY(HISTORY_TIME, AMOUNT, CATEGORY, STORE, CARD_NO) VALUES('18:00', 10000, '미용', '올리브영', '1010-1010-1010-1010');
INSERT INTO TRANSACTION_HISTORY(HISTORY_TIME, AMOUNT, CATEGORY, STORE, CARD_NO) VALUES('19:00', 10000, '미용', '올리브영', '1010-1010-1010-1010');
-----------------------------------
--8. 사용자카드리뷰 CARD_REVIEW

SELECT * FROM CARD_REVIEW;

INSERT INTO CARD_REVIEW(GRADE, BODY, CARD_NO) VALUES (2, '정말 별로에요', '1010-1010-1010-1010');
INSERT INTO CARD_REVIEW(GRADE, BODY, CARD_NO) VALUES (5, '정말 좋아요', '1010-1010-1010-1011');
INSERT INTO CARD_REVIEW(GRADE, BODY, CARD_NO) VALUES (2, '정말 별로에요', '1010-1010-1010-1012');
INSERT INTO CARD_REVIEW(GRADE, BODY, CARD_NO) VALUES (2, '정말 별로에요', '1010-1010-1010-1013');
INSERT INTO CARD_REVIEW(GRADE, BODY, CARD_NO) VALUES (2, '정말 별로에요', '1010-1010-1010-1014');
INSERT INTO CARD_REVIEW(GRADE, BODY, CARD_NO) VALUES (1, '정말 그냥 그래요', '1010-1010-1010-1015');
INSERT INTO CARD_REVIEW(GRADE, BODY, CARD_NO) VALUES (2, '정말 별로에요', '1010-1010-1010-1016');
INSERT INTO CARD_REVIEW(GRADE, BODY, CARD_NO) VALUES (2, '정말 별로에요', '1010-1010-1010-1017');
INSERT INTO CARD_REVIEW(GRADE, BODY, CARD_NO) VALUES (2, '정말 별로에요', '1010-1010-1010-1018');
INSERT INTO CARD_REVIEW(GRADE, BODY, CARD_NO) VALUES (2, '정말 별로에요', '1010-1010-1010-1019');

-----------------------------------
--9. 월간요약통계 MONTHLY SUMMARY
SELECT * FROM MONTHLY_SUMMARY;

INSERT INTO MONTHLY_SUMMARY(CARD_NO, MEMBER_NO, MOST_EXPENDITURE_CATEGORIES, MAX_OF_EXPENDITURE, AVG_OF_EXPENDITURE_PER_CASE, MAX_EXPENDITURE_AREA, MAIN_CARD_NAME)
VALUES('1010-1010-1010-1010', '음식', 100000, 2500,'서울 종로구', '주거래카드');
INSERT INTO MONTHLY_SUMMARY(CARD_NO, MEMBER_NO, MOST_EXPENDITURE_CATEGORIES, MAX_OF_EXPENDITURE, AVG_OF_EXPENDITURE_PER_CASE, MAX_EXPENDITURE_AREA, MAIN_CARD_NAME)
VALUES('1010-1010-1010-1011', '교통', 100000, 2500,'서울 종로구', '주거래카드');
INSERT INTO MONTHLY_SUMMARY(CARD_NO, MEMBER_NO, MOST_EXPENDITURE_CATEGORIES, MAX_OF_EXPENDITURE, AVG_OF_EXPENDITURE_PER_CASE, MAX_EXPENDITURE_AREA, MAIN_CARD_NAME)
VALUES('1010-1010-1010-1012', '유흥', 100000, 2500,'서울 종로구', '주거래카드');
INSERT INTO MONTHLY_SUMMARY(CARD_NO, MEMBER_NO, MOST_EXPENDITURE_CATEGORIES, MAX_OF_EXPENDITURE, AVG_OF_EXPENDITURE_PER_CASE, MAX_EXPENDITURE_AREA, MAIN_CARD_NAME)
VALUES('1010-1010-1010-1013', '카페', 100000, 2500,'서울 종로구', '주거래카드');
INSERT INTO MONTHLY_SUMMARY(CARD_NO, MEMBER_NO, MOST_EXPENDITURE_CATEGORIES, MAX_OF_EXPENDITURE, AVG_OF_EXPENDITURE_PER_CASE, MAX_EXPENDITURE_AREA, MAIN_CARD_NAME)
VALUES('1010-1010-1010-1014', '음식', 100000, 2500,'서울 종로구', '주거래카드');
INSERT INTO MONTHLY_SUMMARY(CARD_NO, MEMBER_NO, MOST_EXPENDITURE_CATEGORIES, MAX_OF_EXPENDITURE, AVG_OF_EXPENDITURE_PER_CASE, MAX_EXPENDITURE_AREA, MAIN_CARD_NAME)
VALUES('1010-1010-1010-1015', '음식', 100000, 2500,'서울 종로구', '주거래카드');
INSERT INTO MONTHLY_SUMMARY(CARD_NO, MEMBER_NO, MOST_EXPENDITURE_CATEGORIES, MAX_OF_EXPENDITURE, AVG_OF_EXPENDITURE_PER_CASE, MAX_EXPENDITURE_AREA, MAIN_CARD_NAME)
VALUES('1010-1010-1010-1016', '음식', 100000, 2500,'서울 종로구', '주거래카드');
INSERT INTO MONTHLY_SUMMARY(CARD_NO, MEMBER_NO, MOST_EXPENDITURE_CATEGORIES, MAX_OF_EXPENDITURE, AVG_OF_EXPENDITURE_PER_CASE, MAX_EXPENDITURE_AREA, MAIN_CARD_NAME)
VALUES('1010-1010-1010-1017', '음식', 100000, 2500,'서울 종로구', '주거래카드');
INSERT INTO MONTHLY_SUMMARY(CARD_NO, MEMBER_NO, MOST_EXPENDITURE_CATEGORIES, MAX_OF_EXPENDITURE, AVG_OF_EXPENDITURE_PER_CASE, MAX_EXPENDITURE_AREA, MAIN_CARD_NAME)
VALUES('1010-1010-1010-1018', '음식', 100000, 2500,'서울 종로구', '주거래카드');
INSERT INTO MONTHLY_SUMMARY(CARD_NO, MEMBER_NO, MOST_EXPENDITURE_CATEGORIES, MAX_OF_EXPENDITURE, AVG_OF_EXPENDITURE_PER_CASE, MAX_EXPENDITURE_AREA, MAIN_CARD_NAME)
VALUES('1010-1010-1010-1019', '음식', 100000, 2500,'서울 종로구', '주거래카드');
-----------------------------------
--10. 공통코드 TOTAL_CODE
SELECT * FROM TOTAL_CODE;
--미정

-----------------------------------
--11. 요약통계로그 SUMMARY_LOG
SELECT * FROM SUMMARY_LOG;

INSERT INTO SUMMARY_LOG(SENDING_DATE, TOTAL, OPEN_RATE) VALUES('2021-01-01', 100000, 30000);
INSERT INTO SUMMARY_LOG(SENDING_DATE, TOTAL, OPEN_RATE) VALUES('2021-02-01', 110000, 70000);
INSERT INTO SUMMARY_LOG(SENDING_DATE, TOTAL, OPEN_RATE) VALUES('2021-03-01', 120000, 80000);
INSERT INTO SUMMARY_LOG(SENDING_DATE, TOTAL, OPEN_RATE) VALUES('2021-04-01', 130000, 90000);
INSERT INTO SUMMARY_LOG(SENDING_DATE, TOTAL, OPEN_RATE) VALUES('2021-05-01', 140000, 100000);
INSERT INTO SUMMARY_LOG(SENDING_DATE, TOTAL, OPEN_RATE) VALUES('2021-06-01', 150000, 100000);
INSERT INTO SUMMARY_LOG(SENDING_DATE, TOTAL, OPEN_RATE) VALUES('2021-07-01', 160000, 100000);
INSERT INTO SUMMARY_LOG(SENDING_DATE, TOTAL, OPEN_RATE) VALUES('2021-08-01', 170000, 100000);
INSERT INTO SUMMARY_LOG(SENDING_DATE, TOTAL, OPEN_RATE) VALUES('2021-09-01', 180000, 100000);
INSERT INTO SUMMARY_LOG(SENDING_DATE, TOTAL, OPEN_RATE) VALUES('2021-10-01', 190000, 100000);



----------------------------------
-- 인사이트 도출부
BEGIN
    UPDATE MEMBER_ACCOUNT SET BALANCE = BALANCE - 1000 WHERE CVC_NO = '111-111-111'; 
    INSERT INTO TRANSACTION_HISTORY(HISTORY_TIME, AMOUNT, CATEGORY, STORE, CARD_NO) VALUES('11:00', 1000, '미용', '올리브영', '1010-1010-1010-1010'); 
    COMMIT;
EXCEPTION
    WHEN OTHERS THEN
    ROLLBACK;
END;    
/

-- 거래가 발생할때 사용한 카드와 연결된 계좌의 금액을 감소시킴과 동시에
-- 소비에 대한 가맹점, 금액, 사용한 카드번호, 일자 등을 로그 테이블에 기록할 수 있도록 함

BEGIN
    INSERT INTO MONTHLY_SUMMARY(MOST_EXPENDITURE_CATEGORIES, MAX_OF_EXPENDITURE, AVG_OF_EXPENDITURE_PER_CASE, MAX_EXPENDITURE_AREA, MAIN_CARD_NAME, CARD_NO)
    VALUES ((SELECT CATEGORY FROM (SELECT CATEGORY, COUNT(CATEGORY) AS CNT FROM TRANSACTION_HISTORY WHERE CARD_NO='1010-1010-1010-1010' GROUP BY CATEGORY ORDER BY CNT DESC) WHERE ROWNUM=1),
    (SELECT MAX(AMOUNT) AS MAX FROM TRANSACTION_HISTORY WHERE CARD_NO= '1010-1010-1010-1010'),
    (SELECT ROUND(SUM(AMOUNT)/COUNT(AMOUNT)) AS AVG FROM TRANSACTION_HISTORY WHERE CARD_NO= '1010-1010-1010-1010'),
    '서울 강남구', '주거래카드', '1010-1010-1010-1010');
    
    INSERT INTO SUMMARY_LOG(SENDING_DATE, TOTAL, OPEN_RATE) VALUES(SYSDATE, 100000, 30000);
    COMMIT;
EXCEPTION
    WHEN OTHERS THEN
    ROLLBACK;
END;    

-- 한달간 발생한 거래에 대해 매월 마지막 날 쯤, 배치 프로그램에 의해 해당월의 최다 지출 카테고리, 최다 지출액, 평균 지출액 등에 대해 계산하고, 인사이트에 대해 월간 요약 테이블에 인서트한다,
-- 또한 최종적으로 데이터가 모두 모이면 LOG테이블에 전체 보고서를 발송할 고객의 수, 예상 열람 고객의 수 등을 기입한다